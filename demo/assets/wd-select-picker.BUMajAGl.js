var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,i=(e,l)=>{for(var a in l||(l={}))s.call(l,a)&&r(e,a,l[a]);if(o)for(var a of o(l))t.call(l,a)&&r(e,a,l[a]);return e},c=(e,o)=>l(e,a(o));import{d as u,r as d,c as n,M as p,C as m,a6 as f,J as v,e as b,f as y,b as h,g as k,w as _,h as w,i as g,D as x,q as C,z as V,E as $,m as j,F as S,j as K,t as z,l as O,K as F,aE as P,n as I,k as q,B,L as M,N as A,aC as T,ad as D}from"./index-Ddr6X_C9.js";import{b as E,c as L,a as W,f as U,m as R,e as N,w as G,_ as H}from"./base64.DGXTDNor.js";import{_ as J}from"./wd-search.D5wf0cfD.js";import{_ as Q}from"./wd-action-sheet.DmMCNgun.js";import{_ as X}from"./wd-checkbox.BfAYgqu7.js";import{w as Y}from"./wd-checkbox-group.BZSoOFnZ.js";import{a as Z,_ as ee}from"./wd-radio-group.BzuXoY-z.js";import{_ as le}from"./wd-button.C_ePM_xj.js";import{e as ae,u as oe,F as se,b as te}from"./wd-loading.CTKNgZO5.js";import{u as re}from"./useTranslate.zeM_cXdJ.js";const ie=c(i({},E),{label:String,labelWidth:W("33%"),disabled:L(!1),readonly:Boolean,placeholder:String,title:String,alignRight:L(!1),error:L(!1),required:L(!1),useLabelSlot:L(!1),useDefaultSlot:L(!1),size:String,checkedColor:String,min:R(0),max:R(0),selectSize:String,loading:L(!1),loadingColor:W("#4D80F0"),closeOnClickModal:L(!0),modelValue:N([String,Number,Boolean,Array]),columns:U(),type:W("checkbox"),valueKey:W("value"),labelKey:W("label"),confirmButtonText:String,displayFormat:Function,beforeConfirm:Function,zIndex:R(15),safeAreaInsetBottom:L(!0),filterable:L(!1),filterPlaceholder:String,ellipsis:L(!1),scrollIntoView:L(!0),prop:String,rules:U(),customContentClass:W(""),customLabelClass:W(""),customValueClass:W(""),showConfirm:L(!0),clearable:L(!1)}),ce=H(u(c(i({},{name:"wd-select-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:ie,emits:["change","cancel","confirm","clear","update:modelValue","open","close"],setup(e,{expose:l,emit:a}){const{translate:o}=re("select-picker"),s=e,t=a,r=d(!1),u=d([]),E=d(!1),L=d([]),W=d(""),U=d([]),R=d(0),N=ae(),H=n((()=>{const e=fe(s.modelValue);let l="";if(s.displayFormat)l=s.displayFormat(e,s.columns);else{const{type:a,labelKey:o}=s;if("checkbox"===a){l=(p(e)?e:[]).map((e=>me(e))).map((e=>e[o])).join(", ")}else if("radio"===a){l=me(e)[o]}else l=e}return l}));m((()=>s.modelValue),(e=>{e!==u.value&&(u.value=fe(e),L.value=fe(e))}),{deep:!0,immediate:!0}),m((()=>s.columns),(e=>{s.filterable&&W.value?ge(e,W.value):U.value=e}),{deep:!0,immediate:!0}),m((()=>s.displayFormat),(e=>{e&&!D(e)&&console.error("The type of displayFormat must be Function")}),{deep:!0,immediate:!0}),m((()=>s.beforeConfirm),(e=>{e&&!D(e)&&console.error("The type of beforeConfirm must be Function")}),{deep:!0,immediate:!0});const{parent:ie}=oe(se),ce=n((()=>ie&&s.prop&&ie.errorMessages&&ie.errorMessages[s.prop]?ie.errorMessages[s.prop]:"")),ue=n((()=>{let e=!1;if(ie&&ie.props.rules){const l=ie.props.rules;for(const a in l)Object.prototype.hasOwnProperty.call(l,a)&&a===s.prop&&Array.isArray(l[a])&&(e=l[a].some((e=>e.required)))}return s.required||s.rules.some((e=>e.required))||e}));f((()=>{u.value=fe(s.modelValue),U.value=s.columns}));const{proxy:de}=v();function ne(){return e=this,l=null,a=function*(){let e="",l=[];B(u.value)&&""!==u.value&&!p(u.value)?(e="#wd-radio-group",l=[M(`#radio${u.value}`,!1,de)]):p(u.value)&&u.value.length>0&&(u.value.forEach((e=>{l.push(M(`#check${e}`,!1,de))})),e="#wd-checkbox-group"),e&&(yield A(2e3/30),Promise.all([M(".wd-select-picker__wrapper",!1,de),M(e,!1,de),...l]).then((e=>{if(B(e)&&p(e)){const l=e[0],a=e[1],o=e.slice(2)||[];B(a)&&B(l)&&o.findIndex((e=>e.bottom>l.top&&e.top<l.bottom))<0&&(R.value=-1,T((()=>{R.value=Math.max(0,o[0].top-a.top-l.height/2)})))}})))},new Promise(((o,s)=>{var t=e=>{try{i(a.next(e))}catch(l){s(l)}},r=e=>{try{i(a.throw(e))}catch(l){s(l)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,r);i((a=a.apply(e,l)).next())}));var e,l,a}function pe(){}function me(e){const{valueKey:l,labelKey:a,columns:o}=s,t=o.filter((a=>a[l]===e));return t.length>0?t[0]:{[l]:e,[a]:""}}function fe(e){return"checkbox"===s.type?p(e)?e:[]:e}function ve({value:e}){u.value=e,t("change",{value:e}),"radio"!==s.type||s.showConfirm||he()}function be(){r.value=!1,E.value||(u.value=fe(L.value)),t("cancel"),t("close")}function ye(){s.disabled||s.readonly||(u.value=fe(s.modelValue),r.value=!0,E.value=!1,t("open"))}function he(){if(s.loading)return r.value=!1,t("confirm"),void t("close");s.beforeConfirm?s.beforeConfirm(u.value,(e=>{e&&ke()})):ke()}function ke(){E.value=!0,r.value=!1,L.value=fe(u.value);let e={};e="checkbox"===s.type?(p(L.value)?L.value:[]).map((e=>me(e))):me(L.value),t("update:modelValue",L.value),t("confirm",{value:L.value,selectedItems:e}),t("close")}function _e(e,l){const a=new RegExp(`(${l})`,"g");return e.split(a).map((e=>({type:e===l?"active":"normal",label:e})))}function we({value:e}){""===e?(U.value=[],W.value=e,T((()=>{U.value=s.columns}))):(W.value=e,ge(s.columns,e))}function ge(e,l){const a=e.filter((e=>e[s.labelKey].indexOf(l)>-1)).map((e=>c(i({},e),{[s.labelKey]:_e(e[s.labelKey],l)})));U.value=[],T((()=>{U.value=a}))}const xe=n((()=>"radio"===s.type&&s.showConfirm||"checkbox"===s.type)),Ce=n((()=>s.clearable&&!s.disabled&&!s.readonly&&H.value.length));function Ve(){t("update:modelValue","checkbox"===s.type?[]:""),t("clear")}const $e=n((()=>!s.disabled&&!s.readonly&&!Ce.value));return l({close:be,open:ye}),(e,l)=>{const a=g,t=b(y("wd-icon"),G),i=b(y("wd-search"),J),c=q,d=P;return k(),h(a,{class:C(`wd-select-picker ${O(N).border.value?"is-border":""} ${e.customClass}`),style:$(e.customStyle)},{default:_((()=>[w(a,{class:"wd-select-picker__field",onClick:ye},{default:_((()=>[e.useDefaultSlot?x(e.$slots,"default",{key:0},void 0,!0):(k(),h(a,{key:1,class:C(`wd-select-picker__cell ${e.disabled&&"is-disabled"} ${s.readonly&&"is-readonly"} ${e.alignRight&&"is-align-right"} ${e.error&&"is-error"} ${e.size&&"is-"+e.size}`)},{default:_((()=>[e.label||e.useLabelSlot?(k(),h(a,{key:0,class:C(`wd-select-picker__label ${ue.value&&"is-required"} ${e.customLabelClass}`),style:$(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:_((()=>[e.label?(k(),j(S,{key:0},[K(z(e.label),1)],64)):x(e.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):V("",!0),w(a,{class:"wd-select-picker__body"},{default:_((()=>[w(a,{class:"wd-select-picker__value-wraper"},{default:_((()=>[w(a,{class:C(`wd-select-picker__value ${e.ellipsis&&"is-ellipsis"} ${e.customValueClass} ${H.value?"":"wd-select-picker__value--placeholder"}`)},{default:_((()=>[K(z(H.value||e.placeholder||O(o)("placeholder")),1)])),_:1},8,["class"]),$e.value?(k(),h(t,{key:0,"custom-class":"wd-select-picker__arrow",name:"arrow-right"})):Ce.value?(k(),h(a,{key:1,onClick:F(Ve,["stop"])},{default:_((()=>[w(t,{"custom-class":"wd-select-picker__clear",name:"error-fill"})])),_:1})):V("",!0)])),_:1}),ce.value?(k(),h(a,{key:0,class:"wd-select-picker__error-message"},{default:_((()=>[K(z(ce.value),1)])),_:1})):V("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),w(Q,{modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=e=>r.value=e),duration:250,title:e.title||O(o)("title"),"close-on-click-modal":e.closeOnClickModal,"z-index":e.zIndex,"safe-area-inset-bottom":e.safeAreaInsetBottom,onClose:be,onOpened:l[4]||(l[4]=l=>e.scrollIntoView?ne():""),"custom-header-class":"wd-select-picker__header"},{default:_((()=>[e.filterable?(k(),h(i,{key:0,modelValue:W.value,"onUpdate:modelValue":l[0]||(l[0]=e=>W.value=e),placeholder:e.filterPlaceholder||O(o)("filterPlaceholder"),"hide-cancel":"","placeholder-left":"",onChange:we},null,8,["modelValue","placeholder"])):V("",!0),w(d,{class:C(`wd-select-picker__wrapper ${e.filterable?"is-filterable":""} ${e.loading?"is-loading":""} ${e.customContentClass}`),"scroll-y":!e.loading,"scroll-top":R.value,"scroll-with-animation":!0},{default:_((()=>["checkbox"===e.type&&O(p)(u.value)?(k(),h(a,{key:0,id:"wd-checkbox-group"},{default:_((()=>[w(Y,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=e=>u.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,min:e.min,max:e.max,onChange:ve},{default:_((()=>[(k(!0),j(S,null,I(U.value,(l=>(k(),h(a,{key:l[e.valueKey],id:"check"+l[e.valueKey]},{default:_((()=>[w(X,{modelValue:l[e.valueKey],disabled:l.disabled},{default:_((()=>[e.filterable&&W.value?(k(!0),j(S,{key:0},I(l[e.labelKey],(e=>(k(),j(S,{key:e.label},["active"===e.type?(k(),h(c,{key:0,class:"wd-select-picker__text-active"},{default:_((()=>[K(z(e.label),1)])),_:2},1024)):(k(),j(S,{key:1},[K(z(e.label),1)],64))],64)))),128)):(k(),j(S,{key:1},[K(z(l[e.labelKey]),1)],64))])),_:2},1032,["modelValue","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color","min","max"])])),_:1})):V("",!0),"radio"!==e.type||O(p)(u.value)?V("",!0):(k(),h(a,{key:1,id:"wd-radio-group"},{default:_((()=>[w(Z,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=e=>u.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,onChange:ve},{default:_((()=>[(k(!0),j(S,null,I(U.value,((l,o)=>(k(),h(a,{key:o,id:"radio"+l[e.valueKey]},{default:_((()=>[w(ee,{value:l[e.valueKey],disabled:l.disabled},{default:_((()=>[e.filterable&&W.value?(k(!0),j(S,{key:0},I(l[e.labelKey],(e=>(k(),h(c,{key:e.label,class:C(""+("active"===e.type?"wd-select-picker__text-active":""))},{default:_((()=>[K(z(e.label),1)])),_:2},1032,["class"])))),128)):(k(),j(S,{key:1},[K(z(l[e.labelKey]),1)],64))])),_:2},1032,["value","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color"])])),_:1})),e.loading?(k(),h(a,{key:2,class:"wd-select-picker__loading",onTouchmove:pe},{default:_((()=>[w(te,{color:e.loadingColor},null,8,["color"])])),_:1})):V("",!0)])),_:1},8,["class","scroll-y","scroll-top"]),xe.value?(k(),h(a,{key:1,class:"wd-select-picker__footer"},{default:_((()=>[w(le,{block:"",size:"large",onClick:he,disabled:e.loading},{default:_((()=>[K(z(e.confirmButtonText||O(o)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):V("",!0)])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])])),_:3},8,["class","style"])}}})),[["__scopeId","data-v-362dd514"]]);export{ce as _};
