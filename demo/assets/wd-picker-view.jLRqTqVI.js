var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&s(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&s(e,t,a[t]);return e},u=(e,l)=>a(e,t(l));import{M as i,aK as c,O as d,d as v,r as m,C as p,J as f,b as g,g as h,w as y,z as b,h as w,i as k,E as C,aL as _,m as x,F as K,n as O,aM as $,q as j,j as P,t as I,ar as S,aC as E,aN as V,as as D,B as H}from"./index-Ddr6X_C9.js";import{b as q}from"./wd-loading.CTKNgZO5.js";import{b as A,f as F,c as N,a as T,m as z,_ as B}from"./base64.DGXTDNor.js";const L=u(r({},A),{loading:N(!1),loadingColor:T("#4D80F0"),columnsHeight:z(217),valueKey:T("value"),labelKey:T("label"),immediateChange:N(!1),modelValue:{type:[String,Number,Boolean,Array,Array,Array],default:"",required:!0},columns:F(),columnChange:Function});function M(e,a,t){let l=i(e)?e:[e];const n=new Set(e.map(c));if(1!==n.size&&n.has("object"))throw Error("The columns are correct");i(e[0])||(l=[l]);return l.map((e=>e.map((e=>{if(!d(e))return{[a]:e,[t]:e};if(!e.hasOwnProperty(a)&&!e.hasOwnProperty(t))throw Error("Can't find valueKey and labelKey in columns");return e.hasOwnProperty(t)||(e[t]=e[a]),e.hasOwnProperty(a)||(e[a]=e[t]),e}))))}const G=B(v(u(r({},{name:"wd-picker-view",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:L,emits:["change","pickstart","pickend","update:modelValue"],setup(e,{expose:a,emit:t}){const l=e,n=t,o=m([]),s=m(35),r=m([]);p([()=>l.modelValue,()=>l.columns],((e,a)=>{D(a[1],e[1])||(i(e[1])&&e[1].length>0?o.value=M(e[1],l.valueKey,l.labelKey):(o.value=[],r.value=[])),H(e[0])&&function(e){if(0===o.value.length)return void(r.value=[]);(""===e||!H(e)||i(e)&&0===e.length)&&(e=o.value.map((e=>e[0][l.valueKey])));const a=c(e),t=["string","number","boolean","array"];-1===t.indexOf(a)&&console.error(`value must be one of ${t.toString()}`);e=(e=i(e)?e:[e]).slice(0,o.value.length);let n=S(r.value);e.forEach(((e,a)=>{let t=o.value[a].findIndex((a=>a[l.valueKey].toString()===e.toString()));t=-1===t?0:t,n=d(a,t,n)})),r.value=n.slice(0,e.length)}(e[0])}),{deep:!0,immediate:!0});const{proxy:u}=f();function d(e,a,t){const l=o.value[e];if(!l||!l[a])throw Error(`The value to select with Col:${e} Row:${a} is incorrect`);const n=S(t);if(n[e]=a,l[a].disabled){const t=l.slice(0,a).reverse().findIndex((e=>!e.disabled)),o=l.slice(a+1).findIndex((e=>!e.disabled));-1!==t?n[e]=a-1-t:-1!==o?n[e]=a+1+o:void 0===n[e]&&(n[e]=0)}return n}function v({detail:{value:e}}){const a=function(e){e=e.slice(0,o.value.length);const a=S(r.value);let t=S(r.value);e.forEach(((e,l)=>{(e=V(e,0,o.value[l].length-1))!==a[l]&&(t=d(l,e,t))}));const l=function(e,a){if(!e||!a)return-1;const t=e.findIndex(((e,t)=>e!==a[t]));return t}(t,a);if(-1===l)return;const n=t[l];return 1===t.length?n:l}(e=e.map((e=>Number(e||0))));r.value=S(e),E((()=>{r.value=function(e){let a=S(e);return e.forEach(((e,t)=>{e=V(e,0,o.value[t].length-1),a=d(t,e,a)})),a}(e),l.columnChange?l.columnChange.length<4?(l.columnChange(u.$.exposed,F(),a||0,(()=>{})),A(a||0)):l.columnChange(u.$.exposed,F(),a||0,(()=>{A(a||0)})):A(a||0)}))}function A(e){const a=N();D(a,l.modelValue)||(n("update:modelValue",a),setTimeout((()=>{n("change",{picker:u.$.exposed,value:a,index:e})}),0))}function F(){const e=r.value.map(((e,a)=>o.value[a][e]));return 1===e.length?e[0]:e}function N(){const{valueKey:e}=l,a=r.value.map(((a,t)=>o.value[t][a][e]));return 1===a.length?a[0]:a}function T(){n("pickstart")}function z(){n("pickend")}return a({getSelects:F,getValues:N,setColumnData:function(e,a,t=0){o.value[e]=M(a,l.valueKey,l.labelKey).reduce(((e,a)=>e.concat(a)),[]),r.value=d(e,t,r.value)},getColumnsData:function(){return S(o.value)},getColumnData:function(e){return o.value[e]},getColumnIndex:function(e){return r.value[e]},getLabels:function(){const{labelKey:e}=l;return r.value.map(((a,t)=>o.value[t][a][e]))},getSelectedIndex:function(){return r.value},resetColumns:function(e){i(e)&&e.length&&(o.value=M(e,l.valueKey,l.labelKey))}}),(e,a)=>{const t=k,l=$,n=_;return h(),g(t,{class:j(`wd-picker-view ${e.customClass}`),style:C(e.customStyle)},{default:y((()=>[e.loading?(h(),g(t,{key:0,class:"wd-picker-view__loading"},{default:y((()=>[w(q,{color:e.loadingColor},null,8,["color"])])),_:1})):b("",!0),w(t,{style:C(`height: ${e.columnsHeight-20}px;`)},{default:y((()=>[w(n,{"mask-class":"wd-picker-view__mask","indicator-class":"wd-picker-view__roller","indicator-style":`height: ${s.value}px;`,style:C(`height: ${e.columnsHeight-20}px;`),value:r.value,"immediate-change":e.immediateChange,onChange:v,onPickstart:T,onPickend:z},{default:y((()=>[(h(!0),x(K,null,O(o.value,((a,n)=>(h(),g(l,{key:n,class:"wd-picker-view-column"},{default:y((()=>[(h(!0),x(K,null,O(a,((a,l)=>(h(),g(t,{key:l,class:j(`wd-picker-view-column__item ${a.disabled?"wd-picker-view-column__item--disabled":""}  ${r.value[n]==l?"wd-picker-view-column__item--active":""}`),style:C(`line-height: ${s.value}px;`)},{default:y((()=>[P(I(a[e.labelKey]),1)])),_:2},1032,["class","style"])))),128))])),_:2},1024)))),128))])),_:1},8,["indicator-style","style","value","immediate-change"])])),_:1},8,["style"])])),_:1},8,["class","style"])}}})),[["__scopeId","data-v-d8f93211"]]);export{M as f,G as w};
