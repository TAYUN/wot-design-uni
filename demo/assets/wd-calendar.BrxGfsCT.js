var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&n(e,t,a[t]);return e},i=(e,l)=>a(e,t(l));import{d,r as u,c as m,ar as c,M as f,C as w,e as p,f as g,b as h,g as v,w as y,z as _,h as D,i as b,D as k,q as Y,E as C,j as F,t as x,l as $,m as M,F as S,n as V,aY as T,N as O,as as j}from"./index-Ddr6X_C9.js";import{_ as P,a as W}from"./wd-tabs.DA8ztzGx.js";import{_ as I}from"./wd-tag.BSyDBm-S.js";import{m as z,b as q,c as A,a as R,f as H,e as L,w as N,_ as U}from"./base64.DGXTDNor.js";import{i as B,w as E,g as G}from"./wd-calendar-view.B7b9oHyk.js";import{_ as Z}from"./wd-action-sheet.DmMCNgun.js";import{_ as J}from"./wd-button.C_ePM_xj.js";import{d as K}from"./dayjs.CMOHtblc.js";import{e as Q,u as X,F as ee}from"./wd-loading.CTKNgZO5.js";import{u as ae}from"./useTranslate.zeM_cXdJ.js";const te=i(o({},q),{modelValue:L([Number,Array,null]),type:R("date"),minDate:z(new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()).getTime()),maxDate:z(new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate(),23,59,59).getTime()),firstDayOfWeek:z(0),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:A(!1),defaultTime:{type:[String,Array]},timeFilter:Function,hideSecond:A(!1),label:String,labelWidth:String,disabled:A(!1),readonly:A(!1),placeholder:String,title:String,alignRight:A(!1),error:A(!1),required:A(!1),size:String,center:A(!1),closeOnClickModal:A(!0),zIndex:z(15),showConfirm:A(!0),confirmText:String,displayFormat:Function,innerDisplayFormat:Function,ellipsis:A(!1),showTypeSwitch:A(!1),shortcuts:H(),onShortcutsClick:Function,safeAreaInsetBottom:A(!0),beforeConfirm:Function,prop:String,rules:H(),customViewClass:R(""),customLabelClass:R(""),customValueClass:R(""),immediateChange:A(!1),withCell:A(!0)}),le=U(d(i(o({},{name:"wd-calendar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:te,emits:["cancel","change","update:modelValue","confirm","open"],setup(e,{expose:a,emit:t}){const{translate:l}=ae("calendar"),r=(e,a)=>{switch(a){case"date":return K(e).format("YYYY-MM-DD");case"dates":return e.map((e=>K(e).format("YYYY-MM-DD"))).join(", ");case"daterange":return`${e[0]?K(e[0]).format("YYYY-MM-DD"):l("startTime")} ${l("to")} ${e[1]?K(e[1]).format("YYYY-MM-DD"):l("endTime")}`;case"datetime":return K(e).format("YYYY-MM-DD HH:mm:ss");case"datetimerange":return`${e[0]?K(e[0]).format(l("timeFormat")):l("startTime")} ${l("to")}\n${e[1]?K(e[1]).format(l("timeFormat")):l("endTime")}`;case"week":{const a=new Date(e),t=a.getFullYear(),r=G(e);new Date(a).setDate(a.getDate()-a.getDay()+1);const s=new Date(a);s.setDate(a.getDate()+(7-a.getDay()));const n=s.getFullYear()>t?s.getFullYear():t;return l("weekFormat",n,T(r))}case"weekrange":{const a=new Date(e[0]),t=new Date(e[1]),r=a.getFullYear(),s=t.getFullYear(),n=G(e[0]),o=G(e[1]);new Date(a).setDate(a.getDate()-a.getDay()+1);const i=new Date(a);i.setDate(a.getDate()+(7-a.getDay()));new Date(t).setDate(t.getDate()-t.getDay()+1);const d=new Date(t);d.setDate(t.getDate()+(7-t.getDay()));const u=i.getFullYear()>r?i.getFullYear():r,m=d.getFullYear()>s?d.getFullYear():s;return`${e[0]?l("weekFormat",u,T(n)):l("startWeek")} - ${e[1]?l("weekFormat",m,T(o)):l("endWeek")}`}case"month":return K(e).format("YYYY / MM");case"monthrange":return`${e[0]?K(e[0]).format("YYYY / MM"):l("startMonth")} ${l("to")} ${e[1]?K(e[1]).format("YYYY / MM"):l("endMonth")}`}},s=(e,a,t)=>{switch(t){case"daterange":return e?K(e).format(l("dateFormat")):l("end"===a?"endTime":"startTime");case"datetimerange":return e?K(e).format(l("timeFormat")):l("end"===a?"endTime":"startTime");case"weekrange":{if(!e)return l("end"===a?"endWeek":"startWeek");const t=new Date(e).getFullYear(),r=G(e);return l("weekFormat",t,T(r))}case"monthrange":return e?K(e).format(l("monthFormat")):l("end"===a?"endMonth":"startMonth")}},n=e,o=t,i=u(!1),d=u(null),z=u(null),q=u(338),A=u(!0),R=u(0),H=u(0),L=u("date"),U=u(),te=u(!1),le=Q(),re=u(),se=u(),ne=m((()=>{const[e,a]=c(f(d.value)?d.value:[]);return[e,a].map(((e,a)=>(n.innerDisplayFormat||s)(e,0===a?"start":"end",L.value)))})),oe=m((()=>!f(n.modelValue)&&n.modelValue||f(n.modelValue)&&n.modelValue.length?(n.displayFormat||r)(n.modelValue,U.value||L.value):""));w((()=>n.modelValue),((e,a)=>{j(e,a)||(d.value=c(e),A.value=pe(e))}),{immediate:!0}),w((()=>n.type),((e,a)=>{if(n.showTypeSwitch){const a=["date","week","month"],t=["daterange","weekrange","monthrange"],l=e.indexOf("range")>-1?t.indexOf(e)||0:a.indexOf(e);R.value=l}q.value=n.showConfirm?338:400,L.value=c(e)}),{deep:!0,immediate:!0}),w((()=>n.showConfirm),(e=>{q.value=e?338:400}),{deep:!0,immediate:!0});const{parent:ie}=X(ee),de=m((()=>ie&&n.prop&&ie.errorMessages&&ie.errorMessages[n.prop]?ie.errorMessages[n.prop]:"")),ue=m((()=>{let e=!1;if(ie&&ie.props.rules){const a=ie.props.rules;for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&t===n.prop&&Array.isArray(a[t])&&(e=a[t].some((e=>e.required)))}return n.required||n.rules.some((e=>e.required))||e})),me=m((()=>e=>B(e)));function ce(){return e=this,a=null,t=function*(){const{disabled:e,readonly:a}=n;e||a||(te.value=!0,i.value=!0,z.value=c(d.value),H.value=R.value,U.value=L.value,yield O(),re.value&&re.value&&re.value.$.exposed.scrollIntoView(),setTimeout((()=>{n.showTypeSwitch&&(se.value.scrollIntoView(),se.value.updateLineStyle(!1))}),250),o("open"))},new Promise(((l,r)=>{var s=e=>{try{o(t.next(e))}catch(a){r(a)}},n=e=>{try{o(t.throw(e))}catch(a){r(a)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,n);o((t=t.apply(e,a)).next())}));var e,a,t}function fe(){i.value=!1,setTimeout((()=>{d.value=c(z.value),R.value=H.value,L.value=U.value||"date",A.value=pe(z.value)}),250),o("cancel")}function we({index:e}){const a=n.type.indexOf("range")>-1?["daterange","weekrange","monthrange"][e]:["date","week","month"][e];R.value=e,L.value=a}function pe(e){let a=!1;return(!(n.type.indexOf("range")>-1)||f(e)&&e[0]&&e[1]&&e)&&("dates"!==n.type||f(e)&&0!==e.length&&e)&&e||(a=!0),a}function ge({value:e}){d.value=c(e),A.value=pe(e),o("change",{value:e}),n.showConfirm||A.value||he()}function he(){n.beforeConfirm?n.beforeConfirm({value:d.value,resolve:e=>{e&&ve()}}):ve()}function ve(){i.value=!1,U.value=L.value,o("update:modelValue",d.value),o("confirm",{value:d.value,type:L.value})}return a({close:fe,open:ce}),(e,a)=>{const t=b,r=p(g("wd-tab"),P),s=p(g("wd-tabs"),W),o=p(g("wd-tag"),I);return v(),h(t,{class:Y(`wd-calendar ${$(le).border.value?"is-border":""} ${e.customClass}`)},{default:y((()=>[e.withCell?(v(),h(t,{key:0,class:"wd-calendar__field",onClick:ce},{default:y((()=>[e.$slots.default?k(e.$slots,"default",{key:0},void 0,!0):(v(),h(t,{key:1,class:Y(`wd-calendar__cell ${e.disabled?"is-disabled":""} ${n.readonly?"is-readonly":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.size?"is-"+e.size:""} ${e.center?"is-center":""}`)},{default:y((()=>[e.label||e.$slots.label?(v(),h(t,{key:0,class:Y(`wd-calendar__label ${ue.value?"is-required":""} ${e.customLabelClass}`),style:C(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:y((()=>[k(e.$slots,"label",{},(()=>[F(x(e.label),1)]),!0)])),_:3},8,["class","style"])):_("",!0),D(t,{class:"wd-calendar__body"},{default:y((()=>[D(t,{class:"wd-calendar__value-wraper"},{default:y((()=>[D(t,{class:Y(`wd-calendar__value ${e.ellipsis?"is-ellipsis":""} ${e.customValueClass} ${oe.value?"":"wd-calendar__value--placeholder"}`)},{default:y((()=>[F(x(oe.value||e.placeholder||$(l)("placeholder")),1)])),_:1},8,["class"]),e.disabled||e.readonly?_("",!0):(v(),h(N,{key:0,"custom-class":"wd-calendar__arrow",name:"arrow-right"}))])),_:1}),de.value?(v(),h(t,{key:0,class:"wd-calendar__error-message"},{default:y((()=>[F(x(de.value),1)])),_:1})):_("",!0)])),_:1})])),_:3},8,["class"]))])),_:3})):_("",!0),D(Z,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value=e),duration:250,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:fe},{default:y((()=>[D(t,{class:"wd-calendar__header"},{default:y((()=>[e.showTypeSwitch||0!==e.shortcuts.length?_("",!0):(v(),h(t,{key:0,class:"wd-calendar__title"},{default:y((()=>[F(x(e.title||$(l)("title")),1)])),_:1})),e.showTypeSwitch?(v(),h(t,{key:1,class:"wd-calendar__tabs"},{default:y((()=>[D(s,{ref_key:"calendarTabs",ref:se,modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=e=>R.value=e),onChange:we},{default:y((()=>[D(r,{title:$(l)("day"),name:$(l)("day")},null,8,["title","name"]),D(r,{title:$(l)("week"),name:$(l)("week")},null,8,["title","name"]),D(r,{title:$(l)("month"),name:$(l)("month")},null,8,["title","name"])])),_:1},8,["modelValue"])])),_:1})):_("",!0),e.shortcuts.length>0?(v(),h(t,{key:2,class:"wd-calendar__shortcuts"},{default:y((()=>[(v(!0),M(S,null,V(e.shortcuts,((e,a)=>(v(),h(o,{key:a,"custom-class":"wd-calendar__tag",type:"primary",plain:"",round:"",onClick:e=>function(e){n.onShortcutsClick&&"function"==typeof n.onShortcutsClick&&(d.value=c(n.onShortcutsClick({item:n.shortcuts[e],index:e})),A.value=pe(d.value)),n.showConfirm||he()}(a)},{default:y((()=>[F(x(e.text),1)])),_:2},1032,["onClick"])))),128))])),_:1})):_("",!0),D(N,{"custom-class":"wd-calendar__close",name:"add",onClick:fe})])),_:1}),te.value?(v(),h(t,{key:0,class:Y(`wd-calendar__view  ${L.value.indexOf("range")>-1?"is-range":""} ${e.showConfirm?"is-show-confirm":""}`)},{default:y((()=>[me.value(e.type)?(v(),h(t,{key:0,class:Y("wd-calendar__range-label "+("monthrange"===e.type?"is-monthrange":""))},{default:y((()=>[D(t,{class:Y("wd-calendar__range-label-item "+(d.value&&$(f)(d.value)&&d.value[0]?"":"is-placeholder")),style:{"text-align":"right"}},{default:y((()=>[F(x(ne.value[0]),1)])),_:1},8,["class"]),D(t,{class:"wd-calendar__range-sperator"},{default:y((()=>[F("/")])),_:1}),D(t,{class:Y("wd-calendar__range-label-item "+(d.value&&$(f)(d.value)&&d.value[1]?"":"is-placeholder"))},{default:y((()=>[F(x(ne.value[1]),1)])),_:1},8,["class"])])),_:1},8,["class"])):_("",!0),D(E,{ref_key:"calendarView",ref:re,modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=e=>d.value=e),type:L.value,"min-date":e.minDate,"max-date":e.maxDate,"first-day-of-week":e.firstDayOfWeek,formatter:e.formatter,"panel-height":q.value,"max-range":e.maxRange,"range-prompt":e.rangePrompt,"allow-same-day":e.allowSameDay,"default-time":e.defaultTime,"time-filter":e.timeFilter,"hide-second":e.hideSecond,"show-panel-title":!me.value(e.type),"immediate-change":e.immediateChange,onChange:ge},null,8,["modelValue","type","min-date","max-date","first-day-of-week","formatter","panel-height","max-range","range-prompt","allow-same-day","default-time","time-filter","hide-second","show-panel-title","immediate-change"])])),_:1},8,["class"])):_("",!0),e.showConfirm?(v(),h(t,{key:1,class:"wd-calendar__confirm"},{default:y((()=>[D(J,{block:"",disabled:A.value,onClick:he},{default:y((()=>[F(x(e.confirmText||$(l)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):_("",!0)])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class"])}}})),[["__scopeId","data-v-8b6b4f97"]]);export{le as _};
